<script type="text/javascript">
	RED.nodes.registerType('filter', {
		category: 'function',
		color: '#A6BBCF',
		defaults: {
			name: { value: "" },
            property: { value: "payload", required: true },
            propertyType: { value: "msg" },
            outputs: { value: 1 }
		},
		inputs: 1,
		outputs: 1,
		icon: "function.png",
		label: function() {
			return this.name || "filter";
		},
        oneditprepare: function() {
            $("#node-input-outputs").spinner({
                min:1
            });

            $("#node-input-property").typedInput({ default: this.propertyType || 'msg', types: ['msg', 'flow', 'global'] });
        },
        oneditsave: function() {
            this.propertyType = $("#node-input-property").typedInput('type');
        }
	});
</script>

<script type="text/x-red" data-template-name="filter">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div class="form-row">
        <label for="node-input-outputs"><i class="fa fa-random"></i> Outputs</label>
        <input id="node-input-outputs" style="width: 60px;" value="1">
    </div>

    <div class="form-row">
        <label for="node-input-property">Property</label>
        <input type="text" id="node-input-property" style="width: 70%"/>
    </div>
</script>

<script type="text/x-red" data-help-name="filter">
    <p>A node that filters incoming message(s) based on configured rules.</p>
</script>
